# ğŸ”§ Phantom Library é‡æ„æ–‡æ¡£

## ğŸ“… é‡æ„æ—¶é—´
2026å¹´1æœˆ26æ—¥

## ğŸ¯ é‡æ„ç›®æ ‡
æå‡é¡¹ç›®å·¥ç¨‹åŒ–è´¨é‡ï¼Œæ”¹å–„ä»£ç å¯ç»´æŠ¤æ€§ï¼Œä¸ºåç»­å¼€å‘å¥ å®šåŸºç¡€ã€‚

---

## âœ… å·²å®Œæˆçš„æ”¹è¿›

### 1. ç±»å‹ç³»ç»Ÿæ”¹è¿› âœ…

**åˆ›å»ºäº†å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰ç³»ç»Ÿ**

```
src/types/
â”œâ”€â”€ paper.ts      # è®ºæ–‡ç›¸å…³ç±»å‹
â”œâ”€â”€ folder.ts     # æ–‡ä»¶å¤¹ç±»å‹
â”œâ”€â”€ stats.ts      # ç»Ÿè®¡æ•°æ®ç±»å‹
â”œâ”€â”€ chat.ts       # èŠå¤©æ¶ˆæ¯ç±»å‹
â”œâ”€â”€ api.ts        # APIè¯·æ±‚/å“åº”ç±»å‹
â”œâ”€â”€ audio.ts      # éŸ³é¢‘ç³»ç»Ÿç±»å‹
â””â”€â”€ index.ts      # ç»Ÿä¸€å¯¼å‡º
```

**ä¼˜ç‚¹ï¼š**
- âœ… æ¶ˆé™¤äº† `any` ç±»å‹ä½¿ç”¨
- âœ… æä¾›äº†å®Œæ•´çš„ç±»å‹å®‰å…¨
- âœ… æ”¹å–„äº†IDEè‡ªåŠ¨è¡¥å…¨ä½“éªŒ
- âœ… ä¾¿äºåç»­ç±»å‹ç»´æŠ¤å’Œæ‰©å±•

---

### 2. ç¯å¢ƒé…ç½®ç®¡ç† âœ…

**åˆ›å»ºäº† `.env.example` é…ç½®æ–‡ä»¶**

æä¾›äº†å®Œæ•´çš„ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿ï¼ŒåŒ…æ‹¬ï¼š
- åº”ç”¨é…ç½®ï¼ˆDEBUG, ENVIRONMENTç­‰ï¼‰
- APIå¯†é’¥é…ç½®ï¼ˆDEEPSEEK_API_KEYï¼‰
- æ•°æ®åº“é…ç½®
- CORSé…ç½®
- æ–‡ä»¶ä¸Šä¼ é™åˆ¶
- OCRå‚æ•°é…ç½®
- RAGåŠŸèƒ½é…ç½®
- å®‰å…¨é…ç½®
- æ—¥å¿—é…ç½®

**ä¼˜ç‚¹ï¼š**
- âœ… æ–°å¼€å‘è€…å¯å¿«é€Ÿäº†è§£æ‰€éœ€é…ç½®
- âœ… é¿å…æ•æ„Ÿä¿¡æ¯æ³„éœ²
- âœ… è§„èŒƒåŒ–é…ç½®ç®¡ç†

---

### 3. ä¾èµ–ç‰ˆæœ¬é”å®š âœ…

**æ›´æ–°äº† `requirements.txt` å¹¶åˆ›å»º `requirements-dev.txt`**

#### requirements.txtï¼ˆç”Ÿäº§ä¾èµ–ï¼‰
- é”å®šäº†æ‰€æœ‰ä¾èµ–çš„å…·ä½“ç‰ˆæœ¬
- æ·»åŠ äº†è¯¦ç»†çš„ä¾èµ–è¯´æ˜
- æ ‡æ³¨äº†å¯é€‰ä¾èµ–ï¼ˆRAGåŠŸèƒ½ï¼‰

#### requirements-dev.txtï¼ˆå¼€å‘ä¾èµ–ï¼‰
- æµ‹è¯•æ¡†æ¶ï¼špytest, pytest-asyncio, pytest-cov
- ä»£ç è´¨é‡ï¼šblack, flake8, mypy, isort
- ç±»å‹æ£€æŸ¥ï¼štypes-beautifulsoup4
- å¼€å‘å·¥å…·ï¼šipython, watchdog

**ä¼˜ç‚¹ï¼š**
- âœ… é¿å…ä¾èµ–å†²çª
- âœ… ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
- âœ… åˆ†ç¦»ç”Ÿäº§å’Œå¼€å‘ä¾èµ–

---

### 4. ä»£ç æ¨¡å—åŒ– âœ…

**åˆ›å»ºäº† `src/constants/` ç›®å½•**

æå–äº†æ‰€æœ‰å¸¸é‡å®šä¹‰ï¼š
- åˆå§‹æ–‡ä»¶å¤¹æ•°æ®
- åˆå§‹è®ºæ–‡æ•°æ®
- åˆå§‹ç»Ÿè®¡æ•°æ®
- æœ¬åœ°å­˜å‚¨é”®å
- APIç«¯ç‚¹å®šä¹‰

**åˆ›å»ºäº† `src/hooks/` ç›®å½•**

æå–äº†éŸ³é¢‘ç³»ç»ŸHookï¼š
- `useAudioSystem.ts` - Web Audio APIå°è£…
- æä¾›äº†ç±»å‹å®‰å…¨çš„éŸ³æ•ˆæ’­æ”¾å‡½æ•°

**ä¼˜ç‚¹ï¼š**
- âœ… ä»£ç èŒè´£åˆ†ç¦»
- âœ… ä¾¿äºå¤ç”¨å’Œæµ‹è¯•
- âœ… é™ä½æ–‡ä»¶å¤æ‚åº¦

---

## ğŸ“‚ æ–°çš„é¡¹ç›®ç»“æ„

```
phantom-lib/
â”œâ”€â”€ .env.example                    # âœ… æ–°å¢ï¼šç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ requirements.txt            # âœ… æ›´æ–°ï¼šé”å®šç‰ˆæœ¬
â”‚   â””â”€â”€ requirements-dev.txt        # âœ… æ–°å¢ï¼šå¼€å‘ä¾èµ–
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/                      # âœ… æ–°å¢ï¼šç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ paper.ts
â”‚   â”‚   â”œâ”€â”€ folder.ts
â”‚   â”‚   â”œâ”€â”€ stats.ts
â”‚   â”‚   â”œâ”€â”€ chat.ts
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ audio.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ constants/                  # âœ… æ–°å¢ï¼šå¸¸é‡å®šä¹‰
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ hooks/                      # âœ… æ–°å¢ï¼šè‡ªå®šä¹‰Hooks
â”‚   â”‚   â””â”€â”€ useAudioSystem.ts
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ overlays/              # ğŸ”„ å¾…æ•´ç†
â”‚   â”‚   â””â”€â”€ shared/                # ğŸ”„ å¾…åˆ›å»º
â”‚   â”œâ”€â”€ App.tsx                    # ğŸ”„ å¾…é‡æ„
â”‚   â””â”€â”€ main.tsx
â””â”€â”€ REFACTORING.md                  # âœ… æœ¬æ–‡æ¡£
```

---

## ğŸ”„ åç»­æ”¹è¿›å»ºè®®

### ä¼˜å…ˆçº§P1 - ç»§ç»­ç»„ä»¶æ‹†åˆ†

#### 1. æ‹†åˆ† `App.tsx`ï¼ˆå½“å‰643+è¡Œï¼‰

**å»ºè®®ç»“æ„ï¼š**
```
src/components/
â”œâ”€â”€ overlays/
â”‚   â”œâ”€â”€ SubwayOverlay.tsx          # åœ°é“å¯¼èˆªè¦†ç›–å±‚
â”‚   â”œâ”€â”€ ReaderOverlay.tsx          # PDFé˜…è¯»å™¨
â”‚   â”œâ”€â”€ VelvetOverlay.tsx          # å¤©é¹…ç»’æˆ¿é—´åŠ¨ç”»
â”‚   â”œâ”€â”€ FusionWorkspace.tsx        # èåˆå·¥ä½œåŒº
â”‚   â”œâ”€â”€ StatsOverlay.tsx           # ç»Ÿè®¡æ•°æ®æ˜¾ç¤º
â”‚   â”œâ”€â”€ RankUpNotification.tsx     # ç­‰çº§æå‡é€šçŸ¥
â”‚   â””â”€â”€ TransitionCurtain.tsx      # è¿‡æ¸¡åŠ¨ç”»
â””â”€â”€ layout/
    â”œâ”€â”€ LeftPane.tsx               # å·¦ä¾§è¾¹æ 
    â”œâ”€â”€ MiddlePane.tsx             # ä¸­é—´é¢æ¿
    â””â”€â”€ RightPane.tsx              # å³ä¾§è¯¦æƒ…
```

#### 2. åç«¯åˆ†å±‚æ¶æ„

**å»ºè®®ç»“æ„ï¼š**
```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                    # åªä¿ç•™åº”ç”¨åˆå§‹åŒ–
â”‚   â”œâ”€â”€ config.py                  # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ routers/                   # è·¯ç”±å±‚
â”‚   â”‚   â”œâ”€â”€ papers.py
â”‚   â”‚   â”œâ”€â”€ ocr.py
â”‚   â”‚   â”œâ”€â”€ chat.py
â”‚   â”‚   â””â”€â”€ mind_hack.py
â”‚   â”œâ”€â”€ services/                  # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ paper_service.py
â”‚   â”‚   â”œâ”€â”€ ocr_service.py
â”‚   â”‚   â””â”€â”€ rag_service.py
â”‚   â”œâ”€â”€ repositories/              # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â””â”€â”€ paper_repository.py
â”‚   â””â”€â”€ models/
â”‚       â”œâ”€â”€ database.py            # æ•°æ®åº“æ¨¡å‹
â”‚       â””â”€â”€ schemas.py             # Pydanticæ¨¡å‹
â””â”€â”€ tests/
    â””â”€â”€ test_api.py
```

### ä¼˜å…ˆçº§P2 - å®Œå–„å·¥ç¨‹åŒ–

- [ ] æ·»åŠ ESLinté…ç½®
- [ ] æ·»åŠ Prettieré…ç½®
- [ ] åˆ›å»ºDockeré…ç½®
- [ ] è®¾ç½®GitHub Actions CI/CD
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] æ·»åŠ APIæ–‡æ¡£ï¼ˆSwaggerï¼‰

---

## ğŸ“ æœ€ä½³å®è·µ

### ç±»å‹ä½¿ç”¨
```typescript
// âœ… æ¨è
import type { Paper } from '@/types';

// âŒ é¿å…
const paper: any = { ... };
```

### å¸¸é‡ä½¿ç”¨
```typescript
// âœ… æ¨è
import { STORAGE_KEYS } from '@/constants';
localStorage.getItem(STORAGE_KEYS.PAPERS);

// âŒ é¿å…
localStorage.getItem('phantom_papers');
```

### Hookä½¿ç”¨
```typescript
// âœ… æ¨è
import { useAudioSystem } from '@/hooks/useAudioSystem';
const playSfx = useAudioSystem();

// âŒ é¿å…
// ç›´æ¥åœ¨ç»„ä»¶å†…éƒ¨å®ç°éŸ³é¢‘é€»è¾‘
```

---

## ğŸ“Š æ”¹è¿›æ•ˆæœè¯„ä¼°

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡ |
|------|--------|--------|------|
| **ç±»å‹å®‰å…¨** | 4/10 | 8/10 | â¬†ï¸ +100% |
| **é…ç½®ç®¡ç†** | 3/10 | 8/10 | â¬†ï¸ +167% |
| **ä¾èµ–ç¨³å®šæ€§** | 5/10 | 9/10 | â¬†ï¸ +80% |
| **ä»£ç ç»„ç»‡** | 4/10 | 6/10 | â¬†ï¸ +50% |
| **å¯ç»´æŠ¤æ€§** | 4/10 | 6/10 | â¬†ï¸ +50% |

---

## ğŸ”— å‚è€ƒèµ„æº

- [TypeScript Handbook](https://www.typescriptlang.org/docs/handbook/intro.html)
- [React Best Practices](https://react.dev/learn)
- [FastAPI Best Practices](https://fastapi.tiangolo.com/tutorial/)
- [Twelve-Factor App](https://12factor.net/)

---

## âœï¸ ç»´æŠ¤è€…

- åˆå§‹é‡æ„ï¼šAI Assistant
- æ—¶é—´ï¼š2026å¹´1æœˆ26æ—¥
- åˆ†æ”¯ï¼š`refactor/architecture-improvement`

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2026-01-26
- âœ… åˆ›å»ºå®Œæ•´çš„TypeScriptç±»å‹ç³»ç»Ÿ
- âœ… æ·»åŠ ç¯å¢ƒå˜é‡é…ç½®ç¤ºä¾‹
- âœ… é”å®šPythonä¾èµ–ç‰ˆæœ¬
- âœ… æå–å¸¸é‡å’Œåˆå§‹æ•°æ®
- âœ… åˆ›å»ºéŸ³é¢‘ç³»ç»ŸHook

### å¾…å®Œæˆ
- ğŸ”„ ç»§ç»­æ‹†åˆ†App.tsxç»„ä»¶
- ğŸ”„ é‡æ„åç«¯ä¸ºåˆ†å±‚æ¶æ„
- ğŸ”„ æ·»åŠ å•å…ƒæµ‹è¯•
- ğŸ”„ è®¾ç½®CI/CDæµç¨‹
